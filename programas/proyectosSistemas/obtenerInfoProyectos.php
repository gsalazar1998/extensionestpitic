<?phpsession_start();if(!isset($_SESSION['usuario'])){	echo "<script>window.location = 'index.php'; </script>";}require_once("../../php/MySQL/ErrorManager.class.php");require_once("../../php/MySQL/MySQL.class.php"); require('../../php/funciones_generales.php');$flag = $_GET['flag'];switch($flag){	case 1: obtenerProyectos($_GET["area"]); break; //Linea 23	case 2: obtenerInfoProyecto($_POST["idcasodes"]); break; //Linea 44	case 3: asignarProyecto($_POST["idcaso"]); break; //Linea 114	case 4: postearComentario($_POST["idcaso"], $_POST["comentario"]); break; //Linea 146	case 5: obtenerComentarios($_POST["idcaso"]); break; //Linea 128	case 6: rechazarProyecto($_POST["idcaso"], $_POST["rechCom"]); break; //Linea 156	case 7: obtenerInfoProyectoReq($_POST["idcasodes"]); break; //Linea 169	case 8: obtenerInfoDirectivos($_POST["idcasodes"]); break; //Linea 446	case 9: grabarRequisitos($_POST["requerimientos"], $_POST["tipo"], $_POST["idcaso"]); break; //Linea 383	case 10: obtenerRequisitos($_POST["idcaso"], $_POST["tipoReq"]); break; //Linea 383	case 11: obtenerFechaTermino($_POST["finicio"], $_POST["idcaso"]); break;	case 12: cambiarPrioridades($_POST["pnueva"], $_POST["idproy"], $_POST["area"], $_POST["pvieja"], $_POST["fectermino"], $_POST["finicio"]); break;}function obtenerProyectos($area){	$mysql = new MySQL();	$mysql->connect(); 	$query = "SELECT * FROM casosDesarrollo WHERE STATUS != '0' AND AREA ='".$area."'";	$result = $mysql->query($query);	$numero = mysql_num_rows($result);	if($numero >0){		$nassign = '{ "aaData": [';		while($row = mysql_fetch_array($result)){			$nassign .='["'.$row['ID_CASODES'].'","'.$row['PRIORIDAD'].'","'.$row['USUARIO'].'","'.$row['DEPTO'].'","'.$row['OFICINA'].'","'.$row['FECHA_INICIO'].'"],';		}		$nassign = substr($nassign,0, -1)."]}";	}else{		$nassign = '{ "aaData": []}';	}	echo $nassign;}function obtenerInfoProyecto($id_proy){	$mysql = new MySQL();	$mysql->connect(); 	$query = "SELECT * FROM casosDesarrollo WHERE ID_CASODES = '".$id_proy."'";	$result = $mysql->query($query);	$numero = mysql_num_rows($result);		echo "<script>	$('#comentar').button();	$('#coms').accordion({		collapsible: true,		autoHeight: false,	});	$('#comentar').click(function(){		$('#comentar_ventana').dialog('open');	})	</script>";			$proyInfo = "<table border='0' style='width:100%;'>";	if($numero >0){		$row = mysql_fetch_array($result);				echo "<script>				$.ajax({					url: 'obtenerInfoProyectos.php?flag=5',					type: 'post',					data: 'idcaso=".$row["ID_CASODES"]."',					success: function(data){						$('#comResp').html(data);					},					failure:function(){						alert('no pude obtener las respuestas');					}				});				</script>";		$adjs = explode(",", $row['ADJUNTOS']);		$proyInfo .= "<tr class='naranjaback centrado'><td>ID PROYECTO</td><td>USUARIO</td><td>DEPARTAMENTO</td><td>OFICINA</td><td>DIRECCION</td><td>FECHA SOLICITUD</td></tr>";		$proyInfo .= "<tr class='centrado'><td>".$row['ID_CASODES']."</td><td>".$row['USUARIO']."</td><td>".$row['DEPTO']."</td><td>".$row['OFICINA']."</td><td>".$row['DIRECCION']."</td><td>".$row['FECHA_ENTRADA']."</td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>PROBLEMA</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['PROBLEMA']."</td></tr>";		$proyInfo .= "<tr><td class='naranjaback' colspan='6'>OBJETIVO DEL PROYECTO</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['OBJETIVO']."</td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>EXPLICACI&Oacute;N DEL FUNCIONAMIENTO DEL PROGRAMA</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['FUNC_PROGRAMA']."</td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>PROCESOS A LOS QUE AFECTA</td></tr>";		$proyInfo .= "<tr><td colspan='6'><ul><li>".str_replace(",","</li><li>",$row['PROCESOS_AFECTADOS'])."</ul></td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>ARCHIVOS ADJUNTOS</td></tr>";		$proyInfo .= "<tr><td colspan='6'><div id='adjuntos' name='adjuntos'>";		foreach($adjs as $ad){			$proyInfo .= "<a id='".$ad."' name='".$ad."' href='archivos/".$ad."' target='_blank'>".$ad."</a>&nbsp;&nbsp;&nbsp;";		}		$proyInfo .= "</div></td></tr>";	}else{		$proyInfo = 'No se encontraron resultados con ese ID de proyecto';	}	$proyInfo .= "</table><br />";	$proyInfo .= "	<div id='coms' name='coms' style='height:100px;'>		<h3><a href='#'>Respuestas</a></h3>		<div class='resp'>			<input type='button' id='comentar' name='comentar' value='comentar' /><br /><br />			<div id='comResp'></div>		</div>	</div>";	echo $proyInfo;}function asignarProyecto(){	$mysql = new MySQL();	$mysql->connect();		$usuario = isset($_POST["usuario"]) ? $_POST["usuario"] : "NO";	$idcaso = isset($_POST["idcaso"]) ? $_POST["idcaso"] : "NO";	if($usuario != "NO" && $idcaso != "NO"){		$rs = mysql_query("UPDATE casosDesarrollo SET ASIGNADO_A = '".$usuario."' WHERE ID_CASODES = ".$idcaso)or die(mysql_error());		if($rs){			echo "OK";		}	}}function obtenerComentarios($idcaso){	$mysql = new MySQL();	$mysql->connect();		$rs = mysql_query("SELECT * FROM casosDes_respuestas WHERE ID_CASODES = '".$idcaso."'")or die(mysql_error());	$respuestas = "";		if(mysql_num_rows($rs) > 0){		while($obj = mysql_fetch_object($rs)){			$respuestas .= "<span style='color:blue'>".$obj->USUARIO."&nbsp;&nbsp;</span><span style='color:red'>".$obj->FECHA."</span><br />".$obj->RESPUESTA."<br /><br />";		}	}else{		$respuestas .= "Aun no hay comentarios";	}		echo $respuestas;}function postearComentario($idcaso, $respuesta){	$mysql = new MySQL();	$mysql->connect();		$rs = mysql_query("INSERT INTO casosDes_respuestas VALUES('".$idcaso."','".$_SESSION['usuario']."','".addslashes($respuesta)."',NOW())")or die(mysql_error());	if($rs){		echo "OK";	}}function rechazarProyecto($idcaso, $respuesta){	$mysql = new MySQL();	$mysql->connect();		$result = mysql_query("UPDATE casosDesarrollo SET status='0' WHERE ID_CASODES = '".$idcaso."'");	if($result){		$rs = mysql_query("INSERT INTO casosDes_respuestas VALUES('".$idcaso."','".$_SESSION['usuario']."','".addslashes($respuesta)."',NOW())")or die(mysql_error());		if($rs){			$result = mysql_query("SELECT PRIORIDAD FROM casosDesarrollo WHERE ID_CASODES = '".$idcaso."'");			$obj = mysql_fetch_object($result);			if($result){				$rset = mysql_query("UPDATE casosDesarrollo SET PRIORIDAD = PRIORIDAD-1 WHERE PRIORIDAD >= ".$obj->PRIORIDAD);				if($rset){					echo "OK";				}			}		}	}}function obtenerInfoProyectoReq($id_proy){	$mysql = new MySQL();	$mysql->connect(); 	$query = "SELECT * FROM casosDesarrollo WHERE ID_CASODES = '".$id_proy."'";	$result = $mysql->query($query);	$numero = mysql_num_rows($result);		//Vamos a verificar si tiene requisitos almacenados para mostrarlos	$obj = obtenerRequisitos($id_proy, 4);		echo "<script>	$('#comentar').button();	$('#coms').accordion({		collapsible: true,		autoHeight: false,		active: -1	});	$('#comentar').click(function(){		$('#comentar_ventana').dialog('open');	})	</script>";			$proyInfo = "<table border='0' style='width:100%;'>";	if($numero >0){		$row = mysql_fetch_array($result);				echo "<script>				$.ajax({					url: 'obtenerInfoProyectos.php?flag=5',					type: 'post',					data: 'idcaso=".$row["ID_CASODES"]."',					success: function(data){						$('#comResp').html(data);					},					failure:function(){						alert('no pude obtener las respuestas');					}				});								$( '#f_inicio' ).datepicker();				$( '#ffin' ).datepicker();								//REQUERIMIENTOS TECNICOS				$('#reqtecni').live('click',function(){					$.ajax({						url: 'obtenerInfoProyectos.php?flag=9',						type: 'post',						data: 'requerimientos='+$('#reqtec').val()+'&tipo=REQ_TECNICOS&idcaso=".$row["ID_CASODES"]."',						success: function(data){							if(data != 0){								$('#reqtecdiv').html(data);								$('#reqtecdiv').effect('highlight', {}, 3000);								$('#botonesreqtec').html('<a id=\"reqtecniEdit\" name=\"rectecniEdit\" href=\"#\" style=\"background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;\">Editar</a>');							}						},						failure:function(){							alert('no se grabaron los requisitos');						}					});				});								$('#reqtecniEdit').live('click',function(){					$.ajax({						url: 'obtenerInfoProyectos.php?flag=10',						type: 'post',						data: 'idcaso=".$row["ID_CASODES"]."&tipoReq=1',						success: function(data){							if(data != 0 || data == ''){								$('#reqtecdiv').html('<textarea id=\"reqtec\" name=\"reqtec\" style=\"width:760px;\">'+data+'</textarea>');								$('#reqtecdiv').effect('highlight', {}, 3000);								$('#botonesreqtec').html('<a id=\"reqtecni\" name=\"rectecni\" href=\"#\" style=\"background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;\">Guardar</a>');							}						},						failure:function(){							alert('no se grabaron los requisitos');						}					});				});								//REQUERIMIENTOS DE PERSONAL				$('#reqpers').live('click',function(){					$.ajax({						url: 'obtenerInfoProyectos.php?flag=9',						type: 'post',						data: 'requerimientos='+$('#reqper').val()+'&tipo=REQ_PERSONAL&idcaso=".$row["ID_CASODES"]."',						success: function(data){							if(data != 0 || data == null || data == ''){								$('#reqperdiv').html(data);								$('#reqperdiv').effect('highlight', {}, 3000);								$('#botonesreqper').html('<a id=\"reqpersonEdit\" name=\"rectecniEdit\" href=\"#\" style=\"background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;\">Editar</a>');							}						},						failure:function(){							alert('no se grabaron los requisitos');						}					});				});								$('#reqpersonEdit').live('click',function(){					$.ajax({						url: 'obtenerInfoProyectos.php?flag=10',						type: 'post',						data: 'idcaso=".$row["ID_CASODES"]."&tipoReq=2',						success: function(data){							if(data != 0){								$('#reqperdiv').html('<textarea id=\"reqper\" name=\"reqper\" style=\"width:760px;\">'+data+'</textarea>');								$('#reqperdiv').effect('highlight', {}, 3000);								$('#botonesreqper').html('<a id=\"reqpers\" name=\"reqpers\" href=\"#\" style=\"background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;\">Guardar</a>');							}						},						failure:function(){							alert('no se grabaron los requisitos');						}					});				});								//REQUERIMIENTOS OTROS				$('#reqotr').live('click',function(){					$.ajax({						url: 'obtenerInfoProyectos.php?flag=9',						type: 'post',						data: 'requerimientos='+$('#reqotro').val()+'&tipo=REQ_OTROS&idcaso=".$row["ID_CASODES"]."',						success: function(data){							if(data != 0 || data == null || data == ''){								$('#reqotrdiv').html(data);								$('#reqotrdiv').effect('highlight', {}, 3000);								$('#botonesreqotr').html('<a id=\"reqotrEdit\" name=\"reqotrEdit\" href=\"#\" style=\"background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;\">Editar</a>');							}						},						failure:function(){							alert('no se grabaron los requisitos');						}					});				});								$('#reqotrEdit').live('click',function(){					$.ajax({						url: 'obtenerInfoProyectos.php?flag=10',						type: 'post',						data: 'idcaso=".$row["ID_CASODES"]."&tipoReq=3',						success: function(data){							if(data != 0){								$('#reqotrdiv').html('<textarea id=\"reqotro\" name=\"reqotro\" style=\"width:760px;\">'+data+'</textarea>');								$('#reqotrdiv').effect('highlight', {}, 3000);								$('#botonesreqotr').html('<a id=\"reqotr\" name=\"reqotr\" href=\"#\" style=\"background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;\">Guardar</a>');							}						},						failure:function(){							alert('no se grabaron los requisitos');						}					});				});				</script>";		$adjs = explode(",", $row['ADJUNTOS']);		$proyInfo .= "<tr class='naranjaback centrado'><td>ID PROYECTO</td><td>USUARIO</td><td>DEPARTAMENTO</td><td>OFICINA</td><td>DIRECCION</td><td>FECHA SOLICITUD</td></tr>";		$proyInfo .= "<tr class='centrado'><td>".$row['ID_CASODES']."</td><td>".$row['USUARIO']."</td><td>".$row['DEPTO']."</td><td>".$row['OFICINA']."</td><td>".$row['DIRECCION']."</td><td>".$row['FECHA_ENTRADA']."</td></tr>";		$proyInfo .= "<tr class='yellowback centrado'><td colspan='2'>STATUS</td><td colspan='2'>FECHA INICIO </td><td colspan='2'>FECHA APROX. DE LIBREACI&Oacute;N</td></tr>";		$proyInfo .= "<tr class='centrado'>		<td colspan='2'><select id='cambiarStatus' name='cambiarStatus'>		<option value='0' ";if($row["STATUS"] == 0){$proyInfo .= "selected='selected'";}$proyInfo .=">Rechazado</option>		<option value='1' ";if($row["STATUS"] == 1){$proyInfo .= "selected='selected'";}$proyInfo .=">Aceptado</option>		<option value='2' ";if($row["STATUS"] == 2){$proyInfo .= "selected='selected'";}$proyInfo .=">En Desarrollo</option>		<option value='3' ";if($row["STATUS"] == 3){$proyInfo .= "selected='selected'";}$proyInfo .=">Fase de Pruebas</option>		<option value='4' ";if($row["STATUS"] == 4){$proyInfo .= "selected='selected'";}$proyInfo .=">Pausado</option>";		/*		switch($row["STATUS"]){			case 0: $proyInfo .= "value='Rechazado' />"; break;			case 1: $proyInfo .= "value='Aceptado' />"; break;			case 2: $proyInfo .= "value='En Desarrollo' />"; break;			case 3: $proyInfo .= "value='Fase de Pruebas' />"; break;			case 4: $proyInfo .= "value='En Pruebas' />"; break;			case 5: $proyInfo .= "value='Pausado' />"; break;		}*/		$proyInfo.= "</select></td><td colspan='2'><input class='centrado' tabindex='2' type='text' id='f_inicio' name='f_inicio' readonly='readonly' /></td><td colspan='2'><input class='centrado' tabindex=1 type='text' id='ffin' name='ffin' readonly='readonly'/></td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>PROBLEMA</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['PROBLEMA']."</td></tr>";		$proyInfo .= "<tr><td class='naranjaback' colspan='6'>OBJETIVO DEL PROYECTO</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['OBJETIVO']."</td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>EXPLICACI&Oacute;N DEL FUNCIONAMIENTO DEL PROGRAMA</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['FUNC_PROGRAMA']."</td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>PROCESOS A LOS QUE AFECTA</td></tr>";		$proyInfo .= "<tr><td colspan='6'><ul><li>".str_replace(",","</li><li>",$row['PROCESOS_AFECTADOS'])."</ul></td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>ARCHIVOS ADJUNTOS</td></tr>";		$proyInfo .= "<tr><td colspan='6'><div id='adjuntos' name='adjuntos'>";		foreach($adjs as $ad){			$proyInfo .= "<a id='".$ad."' name='".$ad."' href='archivos/".$ad."' target='_blank'>".$ad."</a>&nbsp;&nbsp;&nbsp;";		}		$proyInfo .= "</div></td></tr>";		$proyInfo .= "<tr><td colspan='6'><br /><br /><h3>Requerimientos</h3></td></tr>";				//REQUERIMIENTOS TECNICOS		$proyInfo .= "<tr class='greenback'><td colspan='6'>REQUERIMIENTOS TECNICOS<input style='position:relative;left:583px;width:22px;' type='button' value='-' onclick='		if(document.getElementById(\"reqtecdiv\").style.display == \"\" || document.getElementById(\"reqtecdiv\").style.display == \"block\"){			$(\"#reqtecdiv\").hide(\"slow\"); 			this.value=\"+\";		}if(document.getElementById(\"reqtecdiv\").style.display==\"none\"){			$(\"#reqtecdiv\").show(1000); 			this.value=\"-\";		}'/></td></tr>";		$proyInfo .= "<tr><td colspan='6'><div id='reqtecdiv'>";		if($obj){			$proyInfo .= nl2br($obj->REQ_TECNICOS);			$proyInfo .= "</div><div id='botonesreqtec' style='text-align:right; padding:5px; width:760px;'>				<a id='reqtecniEdit' name='rectecniEdit' href='#' style='background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;'>Editar</a>			</div>";		}else{			$proyInfo .= "<textarea id='reqtec' name='reqtec' style='width:760px;'></textarea>			</div><div id='botonesreqtec' style='text-align:right; padding:5px; width:760px;'>				<a id='reqtecni' name='rectecni' href='#' style='background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;'>Guardar</a>			</div>";		}		$proyInfo .= "</td></tr>";		//REQUERIMIENTOS PERSONAL		$proyInfo .= "<tr class='greenback'><td colspan='6'>REQUERIMIENTOS PERSONAL<input style='position:relative;left:583px;width:22px;' type='button' value='-' onclick='		if(document.getElementById(\"reqperdiv\").style.display == \"\" || document.getElementById(\"reqperdiv\").style.display == \"block\"){			$(\"#reqperdiv\").hide(\"slow\"); 			this.value=\"+\";		}if(document.getElementById(\"reqperdiv\").style.display==\"none\"){			$(\"#reqperdiv\").show(1000); 			this.value=\"-\";		}'/></td></tr>";		$proyInfo .= "<tr><td colspan='6'><div id='reqperdiv'>";		if($obj){			$proyInfo .= nl2br($obj->REQ_PERSONAL);			$proyInfo .= "</div><div id='botonesreqper' style='text-align:right; padding:5px; width:760px;'>				<a id='reqpersonEdit' name='rectecniEdit' href='#' style='background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;'>Editar</a>			</div>";		}else{			$proyInfo .= "<textarea id='reqper' name='reqper' style='width:760px;'></textarea>			</div><div id='botonesreqper' style='text-align:right; padding:5px; width:760px;'>				<a id='reqteqpers' name='rectecni' href='#' style='background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;'>Guardar</a>			</div>";		}		$proyInfo .= "</td></tr>";				//OTROS REQUERIMIENTOS		$proyInfo .= "<tr class='greenback'><td colspan='6'>REQUERIMIENTOS OTROS<input style='position:relative;left:600px;width:22px;' type='button' value='-' onclick='		if(document.getElementById(\"reqotrdiv\").style.display == \"\" || document.getElementById(\"reqotrdiv\").style.display == \"block\"){			$(\"#reqotrdiv\").hide(\"slow\"); 			this.value=\"+\";		}if(document.getElementById(\"reqotrdiv\").style.display==\"none\"){			$(\"#reqotrdiv\").show(1000); 			this.value=\"-\";		}'/></td></tr>";		$proyInfo .= "<tr><td colspan='6'><div id='reqotrdiv'>";		if($obj){			$proyInfo .= nl2br($obj->REQ_OTROS);			$proyInfo .= "</div><div id='botonesreqotr' style='text-align:right; padding:5px; width:760px;'>				<a id='reqotrEdit' name='reqotrEdit' href='#' style='background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;'>Editar</a>			</div>";		}else{			$proyInfo .= "<textarea id='reqotro' name='reqotro' style='width:760px;'></textarea>			</div><div id='botonesreqotr' style='text-align:right; padding:5px; width:760px;'>				<a id='reqotr' name='reqotr' href='#' style='background-color:#0FBC65; color:white; border:solid #07D355 1px; text-decoration:none;padding-left:10px;padding-right:10px;'>Guardar</a>			</div>";		}		$proyInfo .= "</td></tr>";	}else{		$proyInfo = 'No se encontraron resultados con ese ID de proyecto';	}	$proyInfo .= "</table><br />";	$proyInfo .= "	<div id='coms' name='coms' style='height:100px;'>		<h3><a href='#'>Respuestas</a></h3>		<div class='resp'>			<input type='button' id='comentar' name='comentar' value='comentar' /><br /><br />			<div id='comResp'></div>		</div>	</div>";	echo $proyInfo;}function obtenerInfoDirectivos($id_proy){	$mysql = new MySQL();	$mysql->connect(); 	$query = "SELECT * FROM casosDesarrollo WHERE ID_CASODES = '".$id_proy."'";	$result = $mysql->query($query);	$numero = mysql_num_rows($result);		echo "<script>	$('#comentar').button();	$('#coms').accordion({		collapsible: true,		autoHeight: false,		active: -1	});	$('#comentar').click(function(){		$('#comentar_ventana').dialog('open');	})	</script>";			$proyInfo = "<table border='0' style='width:100%;'>";	if($numero >0){		$row = mysql_fetch_array($result);				echo "<script>				$.ajax({					url: 'obtenerInfoProyectos.php?flag=5',					type: 'post',					data: 'idcaso=".$row["ID_CASODES"]."',					success: function(data){						$('#comResp').html(data);					},					failure:function(){						alert('no pude obtener las respuestas');					}				});								$( '#finicio' ).datepicker();				$( '#ffin' ).datepicker();								function reprogramarProyectos(proyecto,area,proyecto,prioridad,fec_inicio){					if($('#prioridad').val() == 1 || prioridad ==1){							$('#fidivtag').html('FECHA INICIO DE LA COLA DE PROYECTOS');							$('#fidivtag').css('background-color','#EA6648');							$('#finiciodiv').html('<form id=\"cambiarPriori\" name=\"cambiarPriori\"><input type=\"text\" id=\"finicio\" class=\"validate[required]\" name=\"finicio\" style=\"width:70px;\" readonly=\"readonly\" /></form>');							$( '#finicio' ).datepicker({							altFormat: 'yy-mm-dd',							altField: '#finicio',							onSelect: function(){									$.ajax({										url:'obtenerInfoProyectos.php?flag=11',										data:'finicio='+$('#finicio').val()+'&idcaso='+".$id_proy.",										type:'post',										success:function(data){											$('#ffindiv').html(data);										},										failure:function(){											alert('no se pudo obtener la fecha aproximada de liberacion');										}									})							},							minDate: 0						})						$( '#finicio' ).focus();						$('#finiciodiv').effect('highlight', {}, 1000);						$('#finicio').effect('highlight', {}, 1000);					}else{						$('#fidivtag').html('FECHA INICIO');						$('#finiciodiv').html(fec_inicio);						$('#fidivtag').css('background-color','#BCBC0F');					}					$('#cambiaPrioSaveDiv').html('<br /><input type=\"button\" value=\"Guardar\" id=\"save\" name=\"save\" onclick=\"cambiarPrioridad();\" />&nbsp;&nbsp;<input type=\"button\" value=\"Cancelar\" id=\"cancel\" name=\"cancel\" onclick=\"cancelReprog();\" />')					$('#cambiaPrioSaveDiv').show(1000);					//$('#reprogramarProy').html('asdasd');					//$('#reprogramarProy').dialog('open');					$('#save').button();					$('#cancel').button();				}								function cancelReprog(){					$('#prioridad').find('option[value=\"".$row['PRIORIDAD']."\"]').attr('selected','selected');					//$('#prioridad').val().attr('selected',true);					$('#cambiarPriori').validationEngine('hideAll');					$('#cambiaPrioSaveDiv').hide('slow');					$('#finiciodiv').html('".$row['FECHA_INICIO']."');					$('#ffindiv').html('".$row['FECHA_TERMINO']."');					$('#ffindiv').effect('highlight', {}, 1000);					$('#fidivtag').html('FECHA INICIO');					$('#fidivtag').css('background-color','#BCBC0F');				}												function cambiarPrioridad(){					//alert($('#prioridad').val()+' '+".$id_proy."+' '+'".$row['AREA']." ".$row['PRIORIDAD']."')					if ($('#finicio').length){						fec_inicio = $('#finicio').val()					}else{						fec_inicio= null;					}										if(fec_inicio != null){						if($('#cambiarPriori').validationEngine('validate')){							$.ajax({								url:'obtenerInfoProyectos.php?flag=12',								data:'pnueva='+$('#prioridad').val()+'&idproy=".$id_proy."&area=".$row['AREA']."&pvieja=".$row['PRIORIDAD']."&fectermino='+$('#fectermino').val()+'&finicio='+fec_inicio,								type:'post',								success:function(data){									if(data == 'OK'){										$('#msgDialog').html('Se ha reprogramado el proyecto.');										$('#msgDialog').dialog('open');										$('#infoProyecto').dialog('close');									}									/*$('#ffindiv').effect('highlight', {color:'red'}, 1000);									//$('#ffindiv').html(data);*/								},								failure:function(){									alert('Error de Peticion no se pudo cambiar la prioridad');								}							})						}					}else{						if(fec_inicio == null){fec_inicio='';}						$.ajax({							url:'obtenerInfoProyectos.php?flag=12',							data:'pnueva='+$('#prioridad').val()+'&idproy=".$id_proy."&area=".$row['AREA']."&pvieja=".$row['PRIORIDAD']."&fectermino='+$('#fectermino').val()+'&finicio='+fec_inicio,							type:'post',							success:function(data){								if(data == 'OK'){									$('#msgDialog').html('Se ha reprogramado el proyecto.');									$('#msgDialog').dialog('open');									$('#infoProyecto').dialog('close');								}								/*$('#ffindiv').effect('highlight', {color:'red'}, 1000);								//$('#ffindiv').html(data);*/							},							failure:function(){								alert('Error de Peticion no se pudo cambiar la prioridad');							}						})					}				}				</script>";		$adjs = explode(",", $row['ADJUNTOS']);		$proyInfo .= "<tr class='yellowback centrado'><td>ID PROYECTO</td><td>USUARIO</td><td>DEPARTAMENTO</td><td>OFICINA</td><td>DIRECCION</td><td>FECHA SOLICITUD</td></tr>";		$proyInfo .= "<tr class='centrado'><td>".$row['ID_CASODES']."</td><td>".$row['USUARIO']."</td><td>".$row['DEPTO']."</td><td>".$row['OFICINA']."</td><td>".$row['DIRECCION']."</td><td>".$row['FECHA_ENTRADA']."</td></tr>";		$proyInfo .= "<tr class='yellowback centrado'><td>AREA</td><td style='background-color:red;'>PRIORIDAD</td><td>STATUS</td><td><div id='fidivtag'>FECHA INICIO </div></td><td>FECHA APROX. DE LIBREACI&Oacute;N</td><td>DIAS REQ</td></tr>";		$proyInfo .= "<tr class='centrado'><td>";		if($row['AREA'] == "O"){$proyInfo .= "Operativa";}		elseif($row['AREA'] == "A"){$proyInfo .= "Administrativa";}		$proyInfo .= "</td><td>		<select id='prioridad' name='prioridad' onchange='reprogramarProyectos(".$id_proy.",\"".$row['AREA']."\",\"".$id_proy."\", \"".$row['PRIORIDAD']."\", \"".$row['FECHA_INICIO']."\")'>";				$query = "SELECT COUNT(PRIORIDAD) as NUMPRI FROM casosDesarrollo WHERE AREA = '".$row['AREA']."'";		$rs = $mysql->query($query);		//$numero = mysql_num_rows($rs);		$objnp = mysql_fetch_object($rs);				$q = "SELECT PRIORIDAD FROM casosDesarrollo WHERE ID_CASODES = '".$id_proy."'";		$rset = $mysql->query($q);		//$numero = mysql_num_rows($rset);		$objSel = mysql_fetch_object($rset);				$cont = 1;		while($cont <= $objnp->NUMPRI){			$proyInfo .= "<option value='".$cont."' ";			if($objSel->PRIORIDAD == $cont){$proyInfo .= "selected='selected'";}			$proyInfo .= ">".$cont."</option>";			$cont++;		}				$proyInfo .="</select>		</td><td>";		switch($row['STATUS']){			case 0: $proyInfo.= "Rechazado"; break;			case 1: $proyInfo.= "Aceptado"; break;			case 2: $proyInfo.= "En Desarrollo"; break;			case 3: $proyInfo.= "Fase Desarrollo"; break;			case 4: $proyInfo.= "Finalizado (En Produccion)"; break;		}		$proyInfo.="</td><td><div id='finiciodiv' name='finiciodiv'>".$row['FECHA_INICIO']."</div><td><div id='ffindiv' name='ffindiv'>".$row['FECHA_TERMINO']."</div></td><td>".$row['DIAS_REQUERIDOS']."</td></tr>";		$proyInfo.="<tr><td colspan='6'><div id='cambiaPrioSaveDiv' name='cambiaPrioSaveDiv' style='display:none;width:100%;text-align:right;'></div></td></tr>";				$proyInfo .= "<tr><td colspan='6'><br ><h3>Descripci&oacute;n del Problema</h3></td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>PROBLEMA</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['PROBLEMA']."</td></tr>";		$proyInfo .= "<tr><td class='naranjaback' colspan='6'>OBJETIVO DEL PROYECTO</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['OBJETIVO']."</td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>EXPLICACI&Oacute;N DEL FUNCIONAMIENTO DEL PROGRAMA</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['FUNC_PROGRAMA']."</td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>PROCESOS A LOS QUE AFECTA</td></tr>";		$proyInfo .= "<tr><td colspan='6'><ul><li>".str_replace(",","</li><li>",$row['PROCESOS_AFECTADOS'])."</ul></td></tr>";		$proyInfo .= "<tr class='naranjaback'><td colspan='6'>ARCHIVOS ADJUNTOS</td></tr>";		$proyInfo .= "<tr><td colspan='6'><div id='adjuntos' name='adjuntos'>";		foreach($adjs as $ad){			$proyInfo .= "<a id='".$ad."' name='".$ad."' href='archivos/".$ad."' target='_blank'>".$ad."</a>&nbsp;&nbsp;&nbsp;";		}		$proyInfo .= "</div></td></tr>";		$proyInfo .= "<tr><td colspan='6'><br ><br ><h3>Requerimientos</h3></td></tr>";		$proyInfo .= "<tr class='greenback'><td colspan='6'>REQUERIMIENTOS TECNICOS</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['REQ_TECNICOS']."</td></tr>";		/*$proyInfo .= "<tr class='greenback'><td colspan='6'>REQUERIMIENTOS DE PERSONAL</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['REQ_PERSONAL']."</td></tr>";*/		$proyInfo .= "<tr class='greenback'><td colspan='6'>OTROS REQUERIMIENTOS</td></tr>";		$proyInfo .= "<tr><td colspan='6'>".$row['REQ_OTROS']."</td></tr>";	}else{		$proyInfo = 'No se encontraron resultados con ese ID de proyecto';	}	$proyInfo .= "</table><br />";	$proyInfo .= "	<div id='coms' name='coms' style='height:100px;'>		<h3><a href='#'>Respuestas</a></h3>		<div class='resp'>			<input type='button' id='comentar' name='comentar' value='comentar' /><br /><br />			<div id='comResp'></div>		</div>	</div>";	echo $proyInfo;}function grabarRequisitos($requisitos, $tipo, $idcaso){	$mysql = new MySQL();	$mysql->connect(); 	$result = $mysql->query("UPDATE casosDesarrollo SET ".$tipo." = '".addslashes($requisitos)."' WHERE ID_CASODES = '".$idcaso."'");	//$numero = mysql_num_rows($result);		if($result){		echo nl2br($requisitos);	}else{		echo "0";	}}function obtenerRequisitos($idcaso, $tipoReq){	$mysql = new MySQL();	$mysql->connect(); 	$result = $mysql->query("SELECT REQ_TECNICOS, REQ_PERSONAL, REQ_OTROS FROM casosDesarrollo WHERE ID_CASODES = '".$idcaso."'");	$numero = mysql_num_rows($result);	$obj = mysql_fetch_object($result);		switch($tipoReq){		case 1: echo $obj->REQ_TECNICOS; break;		case 2: echo $obj->REQ_PERSONAL; break;		case 3: echo $obj->REQ_OTROS; break;		case 4: return $obj; break;	}}function obtenerFechaTermino($finicio, $idcaso){	$mysql = new MySQL();	$mysql->connect(); 	$rsult = $mysql->query("SELECT adddate('".$finicio."',DIAS_REQUERIDOS) AS FECHA_TERMINO FROM casosDesarrollo WHERE ID_CASODES = '".$idcaso."'");	$objet = mysql_fetch_object($rsult);	echo "<input type='hidden' id='fectermino' name='fectermino' value='".$objet->FECHA_TERMINO."' />".$objet->FECHA_TERMINO;}function cambiarPrioridades($pnueva, $idcaso, $area, $pvieja, $fectermino, $finicio){	$mysql = new MySQL();	$mysql->connect();		$result = $mysql->query("SELECT ID_CASODES, PRIORIDAD FROM casosDesarrollo WHERE PRIORIDAD = '".$pnueva."' AND AREA = '".$area."'");	$obj = mysql_fetch_object($result);		//Aqui calcularemos los dias entre la fecha de inicio anterior y la nueva para despues cambiar todas las fechas	$rset = $mysql->query("SELECT * FROM casosDesarrollo WHERE ID_CASODES = ".$idcaso);	$objeto = mysql_fetch_object($rset);		if($finicio != "" and isset($finicio)){		$difdias = calcularDiferenciaDias(explode("-",$objeto->FECHA_INICIO),explode("-",$finicio));	}		if($pvieja > $pnueva){		$result = $mysql->query("UPDATE casosDesarrollo SET  PRIORIDAD = ".$pnueva." WHERE ID_CASODES = '".$idcaso."' AND AREA = '".$area."'");		if($result){			$rs = $mysql->query("UPDATE casosDesarrollo SET  PRIORIDAD = PRIORIDAD+1 WHERE PRIORIDAD >= '".$pnueva."' AND PRIORIDAD < ".$pvieja."  AND AREA = '".$area."' AND ID_CASODES != ".$idcaso);			if($rs){				echo "OK";			}		}		/*************************** DE ACA PARA ADELANTE ES DE DONDE SE RECORREN LAS FECHAS ***************************************/			//obtenemos la fecha termino de la prioridad superior		if($pnueva <= 1){			$rs = $mysql->query("SELECT FECHA_TERMINO FROM casosDesarrollo WHERE AREA = '".$area."' AND PRIORIDAD = ".($pnueva));		}else{			$rs = $mysql->query("SELECT FECHA_TERMINO FROM casosDesarrollo WHERE AREA = '".$area."' AND PRIORIDAD = ".($pnueva-1));		}		$objeto = mysql_fetch_object($rs);		//====================				//con todo este chorizo desplazamos las fechas, al haber elevado la prioridad (ejemplo de prioridad 5 a 1) no bajado		if($pnueva <= 1){			$ress = $mysql->query("UPDATE casosDesarrollo SET FECHA_INICIO='".$finicio."' WHERE ID_CASODES = ".$idcaso);		}else{			$rs = $mysql->query("UPDATE casosDesarrollo SET FECHA_INICIO = ADDDATE('".$objeto->FECHA_TERMINO."', 1) WHERE ID_CASODES = ".$idcaso);		}				$query = "SELECT * FROM casosDesarrollo WHERE PRIORIDAD >= '".$pnueva."' AND STATUS != 0 AND AREA = '".$area."' ORDER BY PRIORIDAD";		$rs = $mysql->query($query);		$dr = array();		$ft = array();		$cont = 0;		while($obj = mysql_fetch_object($rs)){			if($obj->PRIORIDAD == $pnueva){				$dr[$cont] = $obj->DIAS_REQUERIDOS;				$q = "UPDATE casosDesarrollo SET FECHA_TERMINO = ADDDATE(FECHA_INICIO, ".$obj->DIAS_REQUERIDOS.") WHERE ID_CASODES = ".$obj->ID_CASODES;				$resu = $mysql->query($q);				$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE ID_CASODES = ".$obj->ID_CASODES);				$object = mysql_fetch_object($r);				$ft[$cont] = $object->FECHA_TERMINO;			}else{				$ft[$cont-1];				$dr[$cont] = $obj->DIAS_REQUERIDOS;				//Cambio la fecha de inicio				$q = "UPDATE casosDesarrollo SET FECHA_INICIO = ADDDATE('".$ft[$cont-1]."',1) WHERE ID_CASODES = ".$obj->ID_CASODES;				$resu = $mysql->query($q);								//Obtengo los valores actualizados para el registro actual				$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE ID_CASODES = ".$obj->ID_CASODES);				$object = mysql_fetch_object($r);								//cambio la fecha final				$r = $mysql->query("UPDATE casosDesarrollo SET FECHA_TERMINO = ADDDATE(FECHA_INICIO, ".$object->DIAS_REQUERIDOS.") WHERE ID_CASODES = ".$obj->ID_CASODES);				//$object = mysql_fetch_object($r);								$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE ID_CASODES = ".$obj->ID_CASODES);				$objeto = mysql_fetch_object($r);								//asigno al arreglo el nuevo fecha termino				$ft[$cont] = $objeto->FECHA_TERMINO;			}			$cont++;		}		/*****************************************************************************************************************************************/	}else{		$result = $mysql->query("UPDATE casosDesarrollo SET FECHA_INICIO = '".$finicio."', FECHA_TERMINO = '".$fectermino."', PRIORIDAD = ".$pnueva." WHERE ID_CASODES = '".$idcaso."' AND AREA = '".$area."'");		if($result){			$rs = $mysql->query("UPDATE casosDesarrollo SET PRIORIDAD = PRIORIDAD-1 WHERE PRIORIDAD <= '".$pnueva."' AND PRIORIDAD > ".$pvieja."  AND AREA = '".$area."' AND ID_CASODES != ".$idcaso);						//si se dio bien el recorrimiento de prioridades			if($rs){							/*************************** DE ACA PARA ADELANTE ES DE DONDE SE RECORREN LAS FECHAS ***************************************/				//obtenemos la fecha termino de la prioridad anterior a la antigua prioridad 			if($pvieja == 1){				$rs = $mysql->query("SELECT * FROM casosDesarrollo WHERE AREA = '".$area."' AND PRIORIDAD = ".($pvieja+1));			}else{				$rs = $mysql->query("SELECT * FROM casosDesarrollo WHERE AREA = '".$area."' AND PRIORIDAD = ".($pvieja-1));			}			$objeto = mysql_fetch_object($rs);			//====================						//con todo este chorizo desplazamos las fechas, al haber disminuido la prioridad (ejemplo de prioridad 2 a 6) no subido			if($pvieja == 1){				$ress = $mysql->query("UPDATE casosDesarrollo SET FECHA_INICIO='".$finicio."' WHERE PRIORIDAD = 1 AND AREA = '".$area."'");				$ress = $mysql->query("UPDATE casosDesarrollo SET FECHA_TERMINO=ADDDATE(FECHA_INICIO,'".$objeto->DIAS_REQUERIDOS."') WHERE PRIORIDAD = 1 AND AREA = '".$area."'");			}/*else{				$rs = $mysql->query("UPDATE casosDesarrollo SET FECHA_INICIO = ADDDATE('".$objeto->FECHA_TERMINO."', 1) WHERE PRIORIDAD = ".$idcaso);			}*/			if($pvieja > 1){				$query = "SELECT * FROM casosDesarrollo WHERE PRIORIDAD >= '".($pvieja-1)."' AND STATUS != 0 AND AREA = '".$area."' ORDER BY PRIORIDAD";			}else{				$query = "SELECT * FROM casosDesarrollo WHERE PRIORIDAD >= '".($pvieja+1)."' AND STATUS != 0 AND AREA = '".$area."' ORDER BY PRIORIDAD";			}			$rs = $mysql->query($query);			$dr = array();			$ft = array();			$cont = 0;			if($pvieja > 1){				while($obj = mysql_fetch_object($rs)){					if($obj->PRIORIDAD == $pvieja){						$dr[$cont] = $obj->DIAS_REQUERIDOS;						$q = "UPDATE casosDesarrollo SET FECHA_INICIO = ADDDATE('".$ft[$cont-1]."', 1) WHERE ID_CASODES = ".$obj->ID_CASODES;						$resu = $mysql->query($q);						$q = "UPDATE casosDesarrollo SET FECHA_TERMINO = ADDDATE(FECHA_INICIO, ".$obj->DIAS_REQUERIDOS.") WHERE ID_CASODES = ".$obj->ID_CASODES;						$resu = $mysql->query($q);												$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE ID_CASODES = ".$obj->ID_CASODES);						$object = mysql_fetch_object($r);						$ft[$cont] = $object->FECHA_TERMINO;					}else{						if($obj->PRIORIDAD == ($pvieja-1)){							$dr[$cont] = $obj->DIAS_REQUERIDOS;							$ft[$cont] = $objeto->FECHA_TERMINO;						}else{							//$ft[$cont-1];							$dr[$cont] = $obj->DIAS_REQUERIDOS;							//Cambio la fecha de inicio							$q = "UPDATE casosDesarrollo SET FECHA_INICIO = ADDDATE('".$ft[$cont-1]."',1) WHERE ID_CASODES = ".$obj->ID_CASODES;							$resu = $mysql->query($q);														//Obtengo los valores actualizados para el registro actual							$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE ID_CASODES = ".$obj->ID_CASODES);							$object = mysql_fetch_object($r);														//cambio la fecha final							$r = $mysql->query("UPDATE casosDesarrollo SET FECHA_TERMINO = ADDDATE(FECHA_INICIO, ".$object->DIAS_REQUERIDOS.") WHERE ID_CASODES = ".$obj->ID_CASODES);							//$object = mysql_fetch_object($r);														$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE ID_CASODES = ".$obj->ID_CASODES);							$objeto = mysql_fetch_object($r);														//asigno al arreglo el nuevo fecha termino							$ft[$cont] = $objeto->FECHA_TERMINO;						}					}					$cont++;			}		}else{			$conta = 1;			while($obj = mysql_fetch_object($rs)){				if($obj->PRIORIDAD == $pvieja+1){					// $obj->DIAS_REQUERIDOS;					$q = "UPDATE casosDesarrollo SET FECHA_INICIO = '".$finicio."' WHERE PRIORIDAD = 1 AND AREA = '".$area."'";					$resu = $mysql->query($q);										$ress = $mysql->query("SELECT DIAS_REQUERIDOS FROM casosDesarrollo WHERE PRIORIDAD = 1 AND AREA = '".$area."'");					$ibj = mysql_fetch_object($ress);										$q = "UPDATE casosDesarrollo SET FECHA_TERMINO = ADDDATE('".$finicio."', ".$ibj->DIAS_REQUERIDOS.") WHERE PRIORIDAD = 1 AND AREA = '".$area."'";					$resu = $mysql->query($q);										$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE PRIORIDAD = 1");					$object = mysql_fetch_object($r);					$ft[$cont] = $object->FECHA_TERMINO;					//echo $cont."=>".$ft[$cont];					$conta++;				}else{					$dr[$cont] = $obj->DIAS_REQUERIDOS;					//Cambio la fecha de inicio					//echo $ft[$cont-1]."<br />";					$q = "UPDATE casosDesarrollo SET FECHA_INICIO = ADDDATE('".$ft[$cont-1]."',1) WHERE PRIORIDAD = ".$conta." AND AREA = '".$area."'";					$resu = $mysql->query($q);										//Obtengo los valores actualizados para el registro actual					$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE PRIORIDAD = ".$conta." AND AREA = '".$area."'");					$object = mysql_fetch_object($r);										//cambio la fecha final					$r = $mysql->query("UPDATE casosDesarrollo SET FECHA_TERMINO = ADDDATE(FECHA_INICIO, ".$object->DIAS_REQUERIDOS.") WHERE PRIORIDAD = ".$conta." AND AREA = '".$area."'");					//$object = mysql_fetch_object($r);										$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE PRIORIDAD = ".$conta." AND AREA = '".$area."'");					$objeto = mysql_fetch_object($r);										//asigno al arreglo el nuevo fecha termino					$ft[$cont] = $objeto->FECHA_TERMINO;					$conta++;				}				$cont++;			}						$q = "UPDATE casosDesarrollo SET FECHA_INICIO = ADDDATE('".$ft[$cont-1]."',1) WHERE PRIORIDAD = ".$conta." AND AREA = '".$area."'";			$resu = $mysql->query($q);						//Obtengo los valores actualizados para el registro actual			$r = $mysql->query("SELECT * FROM casosDesarrollo WHERE PRIORIDAD = ".$conta." AND AREA = '".$area."'");			$object = mysql_fetch_object($r);						//cambio la fecha final			$r = $mysql->query("UPDATE casosDesarrollo SET FECHA_TERMINO = ADDDATE(FECHA_INICIO, ".$object->DIAS_REQUERIDOS.") WHERE PRIORIDAD = ".$conta." AND AREA = '".$area."'");			//$object = mysql_fetch_object($r);		}		/*****************************************************************************************************************************************/				echo "OK";			}		}	}}function calcularDiferenciaDias($fiant, $finue){	//defino fecha1	$ano1 = $finue[0];	$mes1 = $finue[1];	$dia1 = $finue[2];	//defino fecha 2	$ano2 = $fiant[0];	$mes2 = $fiant[1];	$dia2 = $fiant[2];	//calculo timestam de las dos fechas	$timestamp1 = mktime(0,0,0,$mes1,$dia1,$ano1);	$timestamp2 = mktime(4,12,0,$mes2,$dia2,$ano2);	//resto a una fecha la otra	$segundos_diferencia = $timestamp1 - $timestamp2;	//echo $segundos_diferencia;	//convierto segundos en días	$dias_diferencia = $segundos_diferencia / (60 * 60 * 24);	//obtengo el valor absoulto de los días (quito el posible signo negativo)	$dias_diferencia = $dias_diferencia;	//quito los decimales a los días de diferencia	$dias_diferencia = ceil($dias_diferencia);	return $dias_diferencia; }?>